

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>modelcreator.productrecommender package &mdash; Retailanalyzer  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/restyle.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="modelcreator.purchasepredictor package" href="modelcreator.purchasepredictor.html" />
    <link rel="prev" title="modelcreator.datahandler.preprocessor package" href="modelcreator.datahandler.preprocessor.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Retailanalyzer
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">modelcreator</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="modelcreator.html">modelcreator package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="modelcreator.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="modelcreator.datahandler.html">modelcreator.datahandler package</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">modelcreator.productrecommender package</a></li>
<li class="toctree-l4"><a class="reference internal" href="modelcreator.purchasepredictor.html">modelcreator.purchasepredictor package</a></li>
<li class="toctree-l4"><a class="reference internal" href="modelcreator.salesforecaster.html">modelcreator.salesforecaster package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modelcreator.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="modelcreator.html#module-modelcreator.exception">modelcreator.exception module</a></li>
<li class="toctree-l3"><a class="reference internal" href="modelcreator.html#module-modelcreator.model_creator">modelcreator.model_creator module</a></li>
<li class="toctree-l3"><a class="reference internal" href="modelcreator.html#module-modelcreator.model_creator_utils">modelcreator.model_creator_utils module</a></li>
<li class="toctree-l3"><a class="reference internal" href="modelcreator.html#module-modelcreator">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Retailanalyzer</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="modules.html">modelcreator</a> &raquo;</li>
        
          <li><a href="modelcreator.html">modelcreator package</a> &raquo;</li>
        
      <li>modelcreator.productrecommender package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/modelcreator.productrecommender.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="modelcreator-productrecommender-package">
<h1>modelcreator.productrecommender package<a class="headerlink" href="#modelcreator-productrecommender-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-modelcreator.productrecommender.product_recommender">
<span id="modelcreator-productrecommender-product-recommender-module"></span><h2>modelcreator.productrecommender.product_recommender module<a class="headerlink" href="#module-modelcreator.productrecommender.product_recommender" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="modelcreator.productrecommender.product_recommender.ProductRecommender">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">ProductRecommender</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_existing_model</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">logging.Logger</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#modelcreator.productrecommender.product_recommender.ProductRecommender" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Wrapper for an product recommender.</p>
<p>The ProductRecommender class provides the following functionality:</p>
<blockquote>
<div><ul class="simple">
<li><p>Creates a kNN-inspired item-based collaborative filtering recommender (evaluated using hit-rate)</p></li>
<li><p>Loading of pre-existing recommenders via the name attribute</p></li>
<li><p>Recommending the top n products for a given product () or a given customer ().</p></li>
</ul>
</div></blockquote>
<dl class="py attribute">
<dt class="sig sig-object py" id="modelcreator.productrecommender.product_recommender.ProductRecommender.name">
<span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#modelcreator.productrecommender.product_recommender.ProductRecommender.name" title="Permalink to this definition">¶</a></dt>
<dd><p>Passed name used to identify the recommender .</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modelcreator.productrecommender.product_recommender.ProductRecommender._load_model">
<span class="sig-name descname"><span class="pre">_load_model</span></span><a class="headerlink" href="#modelcreator.productrecommender.product_recommender.ProductRecommender._load_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Passed bool that defines if a pre-existing recommender with the same name should be loaded.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modelcreator.productrecommender.product_recommender.ProductRecommender._logger">
<span class="sig-name descname"><span class="pre">_logger</span></span><a class="headerlink" href="#modelcreator.productrecommender.product_recommender.ProductRecommender._logger" title="Permalink to this definition">¶</a></dt>
<dd><p>Passed logger to track execution steps or errors.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Logger</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modelcreator.productrecommender.product_recommender.ProductRecommender._model_subdirectory">
<span class="sig-name descname"><span class="pre">_model_subdirectory</span></span><a class="headerlink" href="#modelcreator.productrecommender.product_recommender.ProductRecommender._model_subdirectory" title="Permalink to this definition">¶</a></dt>
<dd><p>Subdirectory name consisting of the class-name.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modelcreator.productrecommender.product_recommender.ProductRecommender._model_path">
<span class="sig-name descname"><span class="pre">_model_path</span></span><a class="headerlink" href="#modelcreator.productrecommender.product_recommender.ProductRecommender._model_path" title="Permalink to this definition">¶</a></dt>
<dd><p>The path to the directory where the model is stored.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Path</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modelcreator.productrecommender.product_recommender.ProductRecommender._evaluation_dir_path">
<span class="sig-name descname"><span class="pre">_evaluation_dir_path</span></span><a class="headerlink" href="#modelcreator.productrecommender.product_recommender.ProductRecommender._evaluation_dir_path" title="Permalink to this definition">¶</a></dt>
<dd><p>The path to the directory where the model evaluations are stored.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Path</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modelcreator.productrecommender.product_recommender.ProductRecommender._evaluation_file_path">
<span class="sig-name descname"><span class="pre">_evaluation_file_path</span></span><a class="headerlink" href="#modelcreator.productrecommender.product_recommender.ProductRecommender._evaluation_file_path" title="Permalink to this definition">¶</a></dt>
<dd><p>The path to the model evaluation file.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Path</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modelcreator.productrecommender.product_recommender.ProductRecommender._save_file_format">
<span class="sig-name descname"><span class="pre">_save_file_format</span></span><a class="headerlink" href="#modelcreator.productrecommender.product_recommender.ProductRecommender._save_file_format" title="Permalink to this definition">¶</a></dt>
<dd><p>File format used to store the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modelcreator.productrecommender.product_recommender.ProductRecommender._item_neighborhood_matrix_name">
<span class="sig-name descname"><span class="pre">_item_neighborhood_matrix_name</span></span><a class="headerlink" href="#modelcreator.productrecommender.product_recommender.ProductRecommender._item_neighborhood_matrix_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of the item neighborhood matrix (identifier for loading the matrix).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modelcreator.productrecommender.product_recommender.ProductRecommender._customer_item_recommendation_matrix_name">
<span class="sig-name descname"><span class="pre">_customer_item_recommendation_matrix_name</span></span><a class="headerlink" href="#modelcreator.productrecommender.product_recommender.ProductRecommender._customer_item_recommendation_matrix_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of the customer-item recommendation matrix (identifier for loading the matrix).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modelcreator.productrecommender.product_recommender.ProductRecommender._calulate_hit_rate">
<span class="sig-name descname"><span class="pre">_calulate_hit_rate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">test_matrix</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">customer_item_recommendation_matrix</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reciprocal</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#modelcreator.productrecommender.product_recommender.ProductRecommender._calulate_hit_rate" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the per customer averaged hit-rate achieved by the recommender.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>test_matrix</strong> (<em>DataFrame</em>) – Test customer-item matrix as pd.Dataframe with the shape (customers, items) containing the “removed” items, where customerID is the index and the items’ Stock codes are the column names.</p></li>
<li><p><strong>customer_item_recommendation_matrix</strong> (<em>DataFrame</em>) – Matrix containing the top n item recommendations for customers as pd.DataFrame with shape (n_customers, n_items), where the customerID is the index.</p></li>
<li><p><strong>reciprocal</strong> (<em>bool</em>) – Determines if the standard or reciprocal (including the rank of recommended item that achieved a hit) hit-rate should be calculated.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Tuple of the form (train_matrix, test_matrix).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modelcreator.productrecommender.product_recommender.ProductRecommender._construct_customer_item_recommendation_matrix">
<span class="sig-name descname"><span class="pre">_construct_customer_item_recommendation_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">customer_item_matrix</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">item_item_similarity_matrix</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_item_neighborhood_matrix</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pandas.core.frame.DataFrame</span></span></span><a class="headerlink" href="#modelcreator.productrecommender.product_recommender.ProductRecommender._construct_customer_item_recommendation_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the top n recommended items for a single customer.</p>
<p>This function is executed in parallel by <code class="docutils literal notranslate"><span class="pre">_construct_customer_item_recommendation_matrix()</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>customer_item_matrix</strong> (<em>DataFrame</em>) – Customer-item matrix as pd.Dataframe with the shape (customers, items), where customerID is the index and the items’ Stock codes are the column names.</p></li>
<li><p><strong>item_item_similarity_matrix</strong> (<em>DataFrame</em>) – Matrix containing the similarities between items as pd.DataFrame with shape (items, items), where the index and the column names are the items’ Stock codes.</p></li>
<li><p><strong>n_item_neighborhood_matrix</strong> (<em>DataFrame</em>) – Matrix containing the top n neighbor items for each item as pd.DataFrame with shape (items, n), where the index is represented by the Stock codes.</p></li>
<li><p><strong>n</strong> (<em>int</em>) – Number of top recommended items to return.</p></li>
<li><p><strong>n_jobs</strong> (<em>int</em>) – With how much jobs to run the calculation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The customer-item recommendation matrix as pd.DataFrame with shape (customers, top n recommendations) with customerID as index.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modelcreator.productrecommender.product_recommender.ProductRecommender._construct_item_item_similarity_matrix">
<span class="sig-name descname"><span class="pre">_construct_item_item_similarity_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">customer_item_matrix</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pandas.core.frame.DataFrame</span></span></span><a class="headerlink" href="#modelcreator.productrecommender.product_recommender.ProductRecommender._construct_item_item_similarity_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates the item similarity matrix.</p>
<p>Constructs an item similarity matrix based on the item similarities computed with cosinus similarity. The matrix is of shape (items, items), where the index and the column names are the items’ Stock codes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>customer_item_matrix</strong> (<em>DataFrame</em>) – Customer-item matrix as pd.Dataframe with the shape (customers, items), where customerID is the index and the items’ Stock codes are the column names.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The item similarity matrix as pd.DataFrame with shape (items, items).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modelcreator.productrecommender.product_recommender.ProductRecommender._construct_n_item_neighborhood_matrix">
<span class="sig-name descname"><span class="pre">_construct_n_item_neighborhood_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">item_item_similarity_matrix</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pandas.core.frame.DataFrame</span></span></span><a class="headerlink" href="#modelcreator.productrecommender.product_recommender.ProductRecommender._construct_n_item_neighborhood_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates the item neighborhood matrix.</p>
<p>Constructs an item neighborhood matrix based on the item similarity matrix. The matrix is of shape (items, n), where n is the number of most similar neighbors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>item_item_similarity_matrix</strong> (<em>DataFrame</em>) – Matrix containing the similarities between items as pd.DataFrame with shape (items, items), where the index and the column names are the items’ Stock codes.</p></li>
<li><p><strong>n</strong> (<em>int</em>) – Number of most similar neighbors to include in the matrix.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The item-neighborhood matrix as pd.DataFrame with shape (items, n), where the index represents the item Stock codes.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modelcreator.productrecommender.product_recommender.ProductRecommender._get_top_n_item_recommendations_to_customer">
<span class="sig-name descname"><span class="pre">_get_top_n_item_recommendations_to_customer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">customer_id</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">customer_item_matrix</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">item_item_similarity_matrix</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_item_neighborhood_matrix</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span></span></span><a class="headerlink" href="#modelcreator.productrecommender.product_recommender.ProductRecommender._get_top_n_item_recommendations_to_customer" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the top n recommended items for a single customer.</p>
<p>This function is executed in parallel by <code class="docutils literal notranslate"><span class="pre">_construct_customer_item_recommendation_matrix()</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<em>int</em>) – Number of top recommended items to return.</p></li>
<li><p><strong>customer_id</strong> (<em>float</em>) – The customer id to which to find the top recommended items.</p></li>
<li><p><strong>customer_item_matrix</strong> (<em>DataFrame</em>) – Customer-item matrix as pd.Dataframe with the shape (customers, items), where customerID is the index and the items’ Stock codes are the column names.</p></li>
<li><p><strong>item_item_similarity_matrix</strong> (<em>DataFrame</em>) – Matrix containing the similarities between items as pd.DataFrame with shape (items, items), where the index and the column names are the items’ Stock codes.</p></li>
<li><p><strong>n_item_neighborhood_matrix</strong> (<em>DataFrame</em>) – Matrix containing the top n neighbor items for each item as pd.DataFrame with shape (items, n), where the index is represented by the Stock codes.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple containing the <code class="docutils literal notranslate"><span class="pre">customer_id</span></code> as foat as well as the <code class="docutils literal notranslate"><span class="pre">top_n_recommended_items</span></code> as list containing the item codes (first item is the top recommended one, second item the second top and so on).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modelcreator.productrecommender.product_recommender.ProductRecommender._initialize_kNNIBCFRecommender">
<span class="sig-name descname"><span class="pre">_initialize_kNNIBCFRecommender</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">customer_item_matrix</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">number_of_recommendations</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#modelcreator.productrecommender.product_recommender.ProductRecommender._initialize_kNNIBCFRecommender" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes an kNNIBCF recommender.</p>
<p>Wrapper function to encapsulate the steps needed to create an kNNIBCF recommender</p>
<p>This function includes the following steps:</p>
<blockquote>
<div><ul class="simple">
<li><dl class="simple">
<dt>Create 5 random splits of train and test data on which the recommender is trained and evaluated</dt><dd><ul>
<li><p>the mean hit rate is then used as evaluation metric for the recommender</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>Train the recommender on the whole data and store it to disk</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>customer_item_matrix</strong> (<em>DataFrame</em>) – Customer-item matrix as pd.Dataframe with the shape (customers, items), where customerID is the index and the items’ Stock codes are the column names.</p></li>
<li><p><strong>number_of_recommendations</strong> (<em>int</em>) – The number of item recommendations to generate by the recommender for each customer.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modelcreator.productrecommender.product_recommender.ProductRecommender._load_existing_recommender">
<span class="sig-name descname"><span class="pre">_load_existing_recommender</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#modelcreator.productrecommender.product_recommender.ProductRecommender._load_existing_recommender" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads an existing Recomender.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><ul class="simple">
<li><p><a class="reference internal" href="modelcreator.html#modelcreator.exception.ModelNotFoundError" title="modelcreator.exception.ModelNotFoundError"><strong>ModelNotFoundError</strong></a> – If there is no pre-existing recommender under the specified path <code class="docutils literal notranslate"><span class="pre">_model_path</span></code>.</p></li>
<li><p><a class="reference internal" href="modelcreator.html#modelcreator.exception.CorruptRecommenderError" title="modelcreator.exception.CorruptRecommenderError"><strong>CorruptRecommenderError</strong></a> – If the some of the required recommender files (matrices) are missing or corrupted.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modelcreator.productrecommender.product_recommender.ProductRecommender._load_matrix">
<span class="sig-name descname"><span class="pre">_load_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pathlib.Path</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pandas.core.frame.DataFrame</span></span></span><a class="headerlink" href="#modelcreator.productrecommender.product_recommender.ProductRecommender._load_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a matrix stored as .feather at the given path.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>path</strong> (<em>Path</em>) – The path as Path object from which to load the matrix file.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The matrix as pd.DataFrame.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modelcreator.productrecommender.product_recommender.ProductRecommender._random_train_test_split">
<span class="sig-name descname"><span class="pre">_random_train_test_split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">customer_item_matrix</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">items_to_remove</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_generator</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span></span></span><a class="headerlink" href="#modelcreator.productrecommender.product_recommender.ProductRecommender._random_train_test_split" title="Permalink to this definition">¶</a></dt>
<dd><p>Splits the data customer item matrix into training and testing matrix.</p>
<p>The split is done in such a way that <code class="docutils literal notranslate"><span class="pre">items_to_remove</span></code> many items are “removed” (set to 0) from each customer (that has at least 2 * <code class="docutils literal notranslate"><span class="pre">items_to_remove</span></code> purchases) and “put” (set to 1) in the testing set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>customer_item_matrix</strong> (<em>DataFrame</em>) – Customer-item matrix as pd.Dataframe with the shape (customers, items), where customerID is the index and the items’ Stock codes are the column names.</p></li>
<li><p><strong>items_to_remove</strong> (<em>int</em>) – The number of items to “remove” from each customer in the training set to put them into the testing set.</p></li>
<li><p><strong>random_generator</strong> (<em>Generator</em>) – Numpy random generator.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Tuple of the form (train_matrix, test_matrix).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modelcreator.productrecommender.product_recommender.ProductRecommender._save_matrix">
<span class="sig-name descname"><span class="pre">_save_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">matrix</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pathlib.Path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#modelcreator.productrecommender.product_recommender.ProductRecommender._save_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the given matrix to the given path as .feather.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>matrix</strong> (<em>DataFrame</em>) – The matrix to store as pd.DataFrame</p></li>
<li><p><strong>path</strong> (<em>Path</em>) – The path as Path object to which to store the matrix.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modelcreator.productrecommender.product_recommender.ProductRecommender.get_top_recommended_products_for_customer">
<span class="sig-name descname"><span class="pre">get_top_recommended_products_for_customer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">customer_id</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span> </span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_if_not_exists</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">pandas.core.series.Series</span><span class="p"><span class="pre">,</span> </span><span class="pre">pandas.core.frame.DataFrame</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#modelcreator.productrecommender.product_recommender.ProductRecommender.get_top_recommended_products_for_customer" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the top recommended products to the given customer id.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>customer_id</strong> (<em>float</em><em> or </em><em>list</em>) – The customer id to which to find the top recommended items. If <code class="docutils literal notranslate"><span class="pre">customer_id</span></code> is given as list it should include multiple customer IDs for example [id_1, id_2, …] of type float.</p></li>
<li><p><strong>ignore_if_not_exists</strong> (<em>bool</em>) – Determines what to to when a given <code class="docutils literal notranslate"><span class="pre">customer_id</span></code> does not exist. Defaul is False, which raises an error. True will return None. In the case of <code class="docutils literal notranslate"><span class="pre">customer_id</span></code> being a list all entries for the not existent customers are set to np.nan.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>If passed <code class="docutils literal notranslate"><span class="pre">customer_id</span></code> is float the items recommended for the customer with the given <code class="docutils literal notranslate"><span class="pre">customer_id</span></code> as pd.Series where the index represents the rank and the values the stock codes of the items. If the passed <code class="docutils literal notranslate"><span class="pre">customer_id</span></code> is a list, the recommended items for each customer ID in the list as pd.DataFrame where the index represents the customer_id and the columns the recommandation rank with stock codes as values.</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>TypeError</strong> – When type of customer_id is neither float nor list-</p></li>
<li><p><strong>ValueError</strong> – When ignore_if_not_exists = False and the given customer_id does not exist.</p></li>
<li><p><a class="reference internal" href="modelcreator.html#modelcreator.exception.NoTrainedModelError" title="modelcreator.exception.NoTrainedModelError"><strong>NoTrainedModelError</strong></a> – If the function is called but no recommender is ready to make recommendations.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modelcreator.productrecommender.product_recommender.ProductRecommender.get_top_recommended_products_for_product">
<span class="sig-name descname"><span class="pre">get_top_recommended_products_for_product</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stock_code</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_if_not_exists</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">pandas.core.series.Series</span><span class="p"><span class="pre">,</span> </span><span class="pre">pandas.core.frame.DataFrame</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#modelcreator.productrecommender.product_recommender.ProductRecommender.get_top_recommended_products_for_product" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the top products to the given stock_code.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stock_code</strong> (<em>str</em><em> or </em><em>list</em>) – The stock code id to which to find the top recommended items. If <code class="docutils literal notranslate"><span class="pre">stock_code</span></code> is given as list it should include multiple stock codes for example [stock_code_1, stock_code_1, …] of type str.</p></li>
<li><p><strong>ignore_if_not_exists</strong> (<em>bool</em>) – Determines what to to when a given <code class="docutils literal notranslate"><span class="pre">stock_code</span></code> does not exist. Defaul is False, which raises an error. True will return None. In the case of <code class="docutils literal notranslate"><span class="pre">stock_code</span></code> being a list all entries for the not existent stock codes are set to np.nan.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>If passed <code class="docutils literal notranslate"><span class="pre">stock_code</span></code> is str the items recommended for the item with the given stock code as pd.Series where the index represents the rank and the values the stock codes of the items. If the passed <code class="docutils literal notranslate"><span class="pre">stock_code</span></code> is a list, the recommended items for each product in the list as pd.DataFrame where the index represents the stock codes of the passed products and the columns the recommandation rank with the stock codes of recommended items as values.</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>TypeError</strong> – If type is not string.</p></li>
<li><p><strong>ValueError</strong> – If ignore_if_not_exists = False and the given stock_code does not exist.</p></li>
<li><p><a class="reference internal" href="modelcreator.html#modelcreator.exception.NoTrainedModelError" title="modelcreator.exception.NoTrainedModelError"><strong>NoTrainedModelError</strong></a> – If the function is called but no recommender is ready to make recommendations.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modelcreator.productrecommender.product_recommender.ProductRecommender.initialize_recommender">
<span class="sig-name descname"><span class="pre">initialize_recommender</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">customer_item_matrix</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">number_of_recommendations</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#modelcreator.productrecommender.product_recommender.ProductRecommender.initialize_recommender" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes ProductRecommender instance.</p>
<p>This function includes the following steps:</p>
<blockquote>
<div><ul class="simple">
<li><p>Create a subfolder for the ProductRecommender in the models and evaluation folder if it does not exist already</p></li>
<li><p>Create an evaluation file for the recommender</p></li>
<li><p>Initialize a kNNIBCF recommender</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>customer_item_matrix</strong> (<em>DataFrame</em>) – Customer-item matrix as pd.Dataframe with the shape (customers, items), where customerID is the index and the items’ Stock codes are the column names.</p></li>
<li><p><strong>number_of_recommendations</strong> (<em>int</em>) – The number of item recommendations to generate by the recommender for each customer .</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-modelcreator.productrecommender">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-modelcreator.productrecommender" title="Permalink to this headline">¶</a></h2>
<p>productrecommender package</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="modelcreator.purchasepredictor.html" class="btn btn-neutral float-right" title="modelcreator.purchasepredictor package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="modelcreator.datahandler.preprocessor.html" class="btn btn-neutral float-left" title="modelcreator.datahandler.preprocessor package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Luckeneder Marcel.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>